{% extends "tasks/tasks_base.html" %}
{% block title %} Mitasny {% endblock %}
{% block content %}
    <h1> {{ project.title }} </h1>
    <table class="table table-bordered">
{% if project.description %}
        <tr>
            <th> Description </th><td> {{ project.description }} </td>
        </tr>
{% endif %}
    </table>

{% if project.tasks %}
    <table class="table table-bordered table-striped table-condensed">
        <thead>
        <tr>
            <th style="width:0%"> # </th>
            <th style="width:80%"> Name </th>
            <th> Status </th>
            <th> Priority </th>
            <th colspan="2"> Work remaining </th>
            <th colspan="2"> Est. finish date </th>
        </tr>
        </thead>
        <tbody>
    {% for task in project.tasks.all %}
        <tr>
            <td> {{ task.order }} </td>
            <td> <a href="{{ task.get_absolute_url }}"> {{ task.title }} </a> </td>
            <td> {{ task.phase.title }} </td>
            <td> {{ task.priority.title }} </td>
            <td class="text-right"> {{ task.work_left }} </td>
            <td class="text-right"> {{ task.cumulative_work_left }} </td>
            <td class="text-right"> {{ task.finish_date|date:"Y-m-d" }} </td>
            <td> <a class="btn btn-primary btn-xs" href="{% url 'tasks:task_update' task.project.name task.name %}">Edit</a> </td>
        </tr>
    {% endfor %}
        <tr>
            <th colspan="4"> Total </th>
            <th class="text-right"> {{ project.total_work_left }} </th>
            <th> &nbsp;</th>
            <th class="text-right"> {{ project.finish_date|date:"Y-m-d" }} </th>
            <th> &nbsp;</th>
        </tr>
    {% if user.is_authenticated %}
        <tr>
            <td colspan="2"> <a class="btn btn-default" href="{% url 'tasks:task_create' project.name %}"> Create task </a> </td>
        </tr>
    {% endif %}
        </tbody>
    </table>
{% endif %}

{% if user.is_authenticated %}
<p class="text-right"> <a class="btn btn-danger" href="{% url 'tasks:project_delete' project.name %}">Delete project</a> </p>
{% endif %}

{% endblock %}
